<!-- Reading Test Content -->
<div class="reading-test">
    <h3>Reading Section</h3>

    <!-- Passage 1 -->
    <div class="passage mb-4">
        <h4>Passage A: Patient Information Leaflet</h4>
        <div class="card">
            <div class="card-body">
                <p><strong>Medication: Amoxicillin 500mg</strong></p>
                <p><strong>Instructions:</strong> Take one capsule three times daily with food. Complete the full course even if you feel better. Common side effects include nausea, diarrhea, and skin rash. If you experience severe allergic reactions such as difficulty breathing or swelling of face and throat, seek immediate medical attention.</p>
                <p><strong>Storage:</strong> Store in a cool, dry place away from direct sunlight. Keep out of reach of children.</p>
                <p><strong>Warnings:</strong> Do not take if allergic to penicillin. Inform your doctor if you are pregnant or breastfeeding.</p>
            </div>
        </div>
    </div>

    <!-- Questions 1-3 for Passage A -->
    <div class="question-container mb-4">
        <h5>Question 1</h5>
        <p>How often should the medication be taken?</p>
        <div class="form-check clickable-option" onclick="selectAnswer('question_1', '0')">
            <input class="form-check-input" type="radio" name="question_1" id="r1_0" value="0">
            <label class="form-check-label w-100" for="r1_0">Once daily</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_1', '1')">
            <input class="form-check-input" type="radio" name="question_1" id="r1_1" value="1">
            <label class="form-check-label w-100" for="r1_1">Twice daily</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_1', '2')">
            <input class="form-check-input" type="radio" name="question_1" id="r1_2" value="2">
            <label class="form-check-label w-100" for="r1_2">Three times daily</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_1', '3')">
            <input class="form-check-input" type="radio" name="question_1" id="r1_3" value="3">
            <label class="form-check-label w-100" for="r1_3">Four times daily</label>
        </div>
    </div>

    <div class="question-container mb-4">
        <h5>Question 2</h5>
        <p>What should you do if you experience difficulty breathing?</p>
        <div class="form-check clickable-option" onclick="selectAnswer('question_2', '0')">
            <input class="form-check-input" type="radio" name="question_2" id="r2_0" value="0">
            <label class="form-check-label w-100" for="r2_0">Stop taking the medication</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_2', '1')">
            <input class="form-check-input" type="radio" name="question_2" id="r2_1" value="1">
            <label class="form-check-label w-100" for="r2_1">Reduce the dosage</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_2', '2')">
            <input class="form-check-input" type="radio" name="question_2" id="r2_2" value="2">
            <label class="form-check-label w-100" for="r2_2">Seek immediate medical attention</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_2', '3')">
            <input class="form-check-input" type="radio" name="question_2" id="r2_3" value="3">
            <label class="form-check-label w-100" for="r2_3">Take with more food</label>
        </div>
    </div>

    <div class="question-container mb-4">
        <h5>Question 3</h5>
        <p>Who should NOT take this medication?</p>
        <div class="form-check clickable-option" onclick="selectAnswer('question_3', '0')">
            <input class="form-check-input" type="radio" name="question_3" id="r3_0" value="0">
            <label class="form-check-label w-100" for="r3_0">People with diabetes</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_3', '1')">
            <input class="form-check-input" type="radio" name="question_3" id="r3_1" value="1">
            <label class="form-check-label w-100" for="r3_1">People allergic to penicillin</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_3', '2')">
            <input class="form-check-input" type="radio" name="question_3" id="r3_2" value="2">
            <label class="form-check-label w-100" for="r3_2">People over 65</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_3', '3')">
            <input class="form-check-input" type="radio" name="question_3" id="r3_3" value="3">
            <label class="form-check-label w-100" for="r3_3">People with high blood pressure</label>
        </div>
    </div>

    <!-- Passage 2 -->
    <div class="passage mb-4">
        <h4>Passage B: Hospital Discharge Summary</h4>
        <div class="card">
            <div class="card-body">
                <p><strong>Patient:</strong> Mary Johnson, 68 years old</p>
                <p><strong>Admission Date:</strong> March 15, 2024</p>
                <p><strong>Discharge Date:</strong> March 20, 2024</p>
                <p><strong>Diagnosis:</strong> Acute myocardial infarction (heart attack)</p>
                <p><strong>Treatment:</strong> Patient underwent emergency angioplasty and received two cardiac stents. Medication regimen includes aspirin, clopidogrel, atorvastatin, and metoprolol. Follow-up appointment with cardiologist scheduled for April 3, 2024.</p>
                <p><strong>Discharge Instructions:</strong> Rest for two weeks. No heavy lifting or strenuous activity. Take medications as prescribed. Monitor for chest pain, shortness of breath, or unusual fatigue. Contact emergency services immediately if symptoms return.</p>
            </div>
        </div>
    </div>

    <!-- Questions 4-6 for Passage B -->
    <div class="question-container mb-4">
        <h5>Question 4</h5>
        <p>What procedure did the patient undergo?</p>
        <div class="form-check clickable-option" onclick="selectAnswer('question_4', '0')">
            <input class="form-check-input" type="radio" name="question_4" id="r4_0" value="0">
            <label class="form-check-label w-100" for="r4_0">Bypass surgery</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_4', '1')">
            <input class="form-check-input" type="radio" name="question_4" id="r4_1" value="1">
            <label class="form-check-label w-100" for="r4_1">Angioplasty with stents</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_4', '2')">
            <input class="form-check-input" type="radio" name="question_4" id="r4_2" value="2">
            <label class="form-check-label w-100" for="r4_2">Pacemaker insertion</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_4', '3')">
            <input class="form-check-input" type="radio" name="question_4" id="r4_3" value="3">
            <label class="form-check-label w-100" for="r4_3">Valve replacement</label>
        </div>
    </div>

    <div class="question-container mb-4">
        <h5>Question 5</h5>
        <p>How long should the patient rest after discharge?</p>
        <div class="form-check clickable-option" onclick="selectAnswer('question_5', '0')">
            <input class="form-check-input" type="radio" name="question_5" id="r5_0" value="0">
            <label class="form-check-label w-100" for="r5_0">One week</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_5', '1')">
            <input class="form-check-input" type="radio" name="question_5" id="r5_1" value="1">
            <label class="form-check-label w-100" for="r5_1">Two weeks</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_5', '2')">
            <input class="form-check-input" type="radio" name="question_5" id="r5_2" value="2">
            <label class="form-check-label w-100" for="r5_2">One month</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_5', '3')">
            <input class="form-check-input" type="radio" name="question_5" id="r5_3" value="3">
            <label class="form-check-label w-100" for="r5_3">Three months</label>
        </div>
    </div>

    <div class="question-container mb-4">
        <h5>Question 6</h5>
        <p>When is the follow-up appointment scheduled?</p>
        <div class="form-check clickable-option" onclick="selectAnswer('question_6', '0')">
            <input class="form-check-input" type="radio" name="question_6" id="r6_0" value="0">
            <label class="form-check-label w-100" for="r6_0">March 30, 2024</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_6', '1')">
            <input class="form-check-input" type="radio" name="question_6" id="r6_1" value="1">
            <label class="form-check-label w-100" for="r6_1">April 3, 2024</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_6', '2')">
            <input class="form-check-input" type="radio" name="question_6" id="r6_2" value="2">
            <label class="form-check-label w-100" for="r6_2">April 15, 2024</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_6', '3')">
            <input class="form-check-input" type="radio" name="question_6" id="r6_3" value="3">
            <label class="form-check-label w-100" for="r6_3">May 1, 2024</label>
        </div>
    </div>

    <!-- Passage 3 -->
    <div class="passage mb-4">
        <h4>Passage C: Clinical Guidelines - Diabetes Management</h4>
        <div class="card">
            <div class="card-body">
                <p><strong>Blood Glucose Monitoring:</strong> Patients with Type 1 diabetes should test blood glucose levels at least four times daily: before meals and at bedtime. Type 2 diabetes patients on insulin should test twice daily. Target pre-meal glucose levels should be 4.0-7.0 mmol/L.</p>
                <p><strong>Exercise Recommendations:</strong> Moderate physical activity for 150 minutes per week is recommended. Patients should monitor blood glucose before, during, and after exercise. Extra carbohydrates may be needed to prevent hypoglycemia during prolonged activity.</p>
                <p><strong>Foot Care:</strong> Daily foot inspection is essential. Look for cuts, sores, swelling, or changes in skin color. Wash feet daily with warm water and mild soap. Dry thoroughly, especially between toes.</p>
            </div>
        </div>
    </div>

    <!-- Questions 7-9 for Passage C -->
    <div class="question-container mb-4">
        <h5>Question 7</h5>
        <p>How often should Type 1 diabetes patients test their blood glucose?</p>
        <div class="form-check clickable-option" onclick="selectAnswer('question_7', '0')">
            <input class="form-check-input" type="radio" name="question_7" id="r7_0" value="0">
            <label class="form-check-label w-100" for="r7_0">Once daily</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_7', '1')">
            <input class="form-check-input" type="radio" name="question_7" id="r7_1" value="1">
            <label class="form-check-label w-100" for="r7_1">Twice daily</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_7', '2')">
            <input class="form-check-input" type="radio" name="question_7" id="r7_2" value="2">
            <label class="form-check-label w-100" for="r7_2">Three times daily</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_7', '3')">
            <input class="form-check-input" type="radio" name="question_7" id="r7_3" value="3">
            <label class="form-check-label w-100" for="r7_3">At least four times daily</label>
        </div>
    </div>

    <div class="question-container mb-4">
        <h5>Question 8</h5>
        <p>What is the target pre-meal glucose level range?</p>
        <div class="form-check clickable-option" onclick="selectAnswer('question_8', '0')">
            <input class="form-check-input" type="radio" name="question_8" id="r8_0" value="0">
            <label class="form-check-label w-100" for="r8_0">3.0-6.0 mmol/L</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_8', '1')">
            <input class="form-check-input" type="radio" name="question_8" id="r8_1" value="1">
            <label class="form-check-label w-100" for="r8_1">4.0-7.0 mmol/L</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_8', '2')">
            <input class="form-check-input" type="radio" name="question_8" id="r8_2" value="2">
            <label class="form-check-label w-100" for="r8_2">5.0-8.0 mmol/L</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_8', '3')">
            <input class="form-check-input" type="radio" name="question_8" id="r8_3" value="3">
            <label class="form-check-label w-100" for="r8_3">6.0-9.0 mmol/L</label>
        </div>
    </div>

    <div class="question-container mb-4">
        <h5>Question 9</h5>
        <p>How many minutes of moderate exercise are recommended per week?</p>
        <div class="form-check clickable-option" onclick="selectAnswer('question_9', '0')">
            <input class="form-check-input" type="radio" name="question_9" id="r9_0" value="0">
            <label class="form-check-label w-100" for="r9_0">100 minutes</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_9', '1')">
            <input class="form-check-input" type="radio" name="question_9" id="r9_1" value="1">
            <label class="form-check-label w-100" for="r9_1">120 minutes</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_9', '2')">
            <input class="form-check-input" type="radio" name="question_9" id="r9_2" value="2">
            <label class="form-check-label w-100" for="r9_2">150 minutes</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_9', '3')">
            <input class="form-check-input" type="radio" name="question_9" id="r9_3" value="3">
            <label class="form-check-label w-100" for="r9_3">200 minutes</label>
        </div>
    </div>

    <div class="question-container mb-4">
        <h5>Question 10</h5>
        <p>Why should diabetic patients pay special attention to foot care?</p>
        <div class="form-check clickable-option" onclick="selectAnswer('question_10', '0')">
            <input class="form-check-input" type="radio" name="question_10" id="r10_0" value="0">
            <label class="form-check-label w-100" for="r10_0">To improve circulation</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_10', '1')">
            <input class="form-check-input" type="radio" name="question_10" id="r10_1" value="1">
            <label class="form-check-label w-100" for="r10_1">To prevent infections and complications</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_10', '2')">
            <input class="form-check-input" type="radio" name="question_10" id="r10_2" value="2">
            <label class="form-check-label w-100" for="r10_2">To reduce swelling</label>
        </div>
        <div class="form-check clickable-option" onclick="selectAnswer('question_10', '3')">
            <input class="form-check-input" type="radio" name="question_10" id="r10_3" value="3">
            <label class="form-check-label w-100" for="r10_3">To maintain flexibility</label>
        </div>
    </div>
</div>

<script>
// Correct answers for scoring
const correctAnswers = {
    'question_1': '2',  // Three times daily
    'question_2': '2',  // Seek immediate medical attention
    'question_3': '1',  // People allergic to penicillin
    'question_4': '1',  // Angioplasty with stents
    'question_5': '1',  // Two weeks
    'question_6': '1',  // April 3, 2024
    'question_7': '3',  // At least four times daily
    'question_8': '1',  // 4.0-7.0 mmol/L
    'question_9': '2',  // 150 minutes
    'question_10': '1'  // To prevent infections and complications
};

// Function to handle answer selection and scoring
function selectAnswer(questionName, selectedValue) {
    const questionElements = document.querySelectorAll(`input[name="${questionName}"]`);
    questionElements.forEach(el => {
        if (el.value === selectedValue) {
            el.checked = true;
        } else {
            el.checked = false;
        }
    });

    // Recalculate score
    calculateScore();
}

function calculateScore() {
    let score = 0;
    let totalQuestions = 0;
    const answeredQuestions = {};

    // Get all question names from the correctAnswers object
    const questionNames = Object.keys(correctAnswers);

    // Count total number of questions
    totalQuestions = questionNames.length;

    // Track which questions have been answered
    const userAnswers = {};
    document.querySelectorAll('.question-container').forEach(container => {
        const questionElement = container.querySelector('h5');
        if (questionElement) {
            const questionName = questionElement.nextElementSibling.getAttribute('name');
            if (questionName) {
                const selectedInput = container.querySelector(`input[name="${questionName}"]:checked`);
                if (selectedInput) {
                    userAnswers[questionName] = selectedInput.value;
                }
            }
        }
    });

    // Calculate score based on user answers and correct answers
    let correctCount = 0;
    for (const questionName in correctAnswers) {
        if (userAnswers.hasOwnProperty(questionName)) {
            if (userAnswers[questionName] === correctAnswers[questionName]) {
                correctCount++;
            }
        }
    }

    // Calculate percentage
    if (totalQuestions > 0) {
        score = (correctCount / totalQuestions) * 100;
    }

    // Display the score
    const scoreDisplay = document.getElementById('score-display');
    if (scoreDisplay) {
        scoreDisplay.textContent = `Your Score: ${score.toFixed(0)}%`;
    }
}


// Store correct answers in a global variable for access in routes
window.testAnswers = correctAnswers;

// Add event listeners for radio buttons if not using onclick
document.addEventListener('DOMContentLoaded', () => {
    const radioButtons = document.querySelectorAll('.form-check-input');
    radioButtons.forEach(radio => {
        radio.addEventListener('change', calculateScore);
    });

    // Initial score calculation on page load in case answers are pre-selected
    calculateScore();
});
</script>

<!-- Score Display Area -->
<div id="score-display" class="mt-3 text-center font-weight-bold"></div>